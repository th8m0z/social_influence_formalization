"0","dunning_kruger_confidence <- function(PK) {"
"0","  # Validate input"
"0","  if (!is.numeric(PK) || any(PK < 0) || any(PK > 1)) {"
"0","    stop(""PK must be a numeric value between 0 and 1"")"
"0","  }"
"0","  "
"0","  # Recalibrated coefficients to exactly hit both key points"
"0","  a = 0.4      # Base confidence at zero knowledge"
"0","  b = 1.0      # Controls initial rise"
"0","  c = -1.2     # Creates the curve shape"
"0","  d = 0.7      # Adjusts high-end behavior"
"0","  "
"0","  # Calculate perceived percentile rank"
"0","  perceived_rank <- a + b*PK + c*PK^2 + d*PK^3"
"0","  "
"0","  # Ensure all values stay in [0,1] range"
"0","  perceived_rank <- pmin(pmax(perceived_rank, 0), 1)"
"0","  "
"0","  return(perceived_rank)"
"0","}"
"0",""
"0",""
"0","# Create a visualization"
"0","plot_dunning_kruger <- function() {"
"0","  # Generate sequence of PK values for smooth curve"
"0","  PK_values <- seq(0, 1, by=0.01)"
"0","  confidence_values <- dunning_kruger_confidence(PK_values)"
"0","  "
"0","  # Find where the curve crosses the identity line"
"0","  crossings <- which(diff(sign(confidence_values - PK_values)) != 0)"
"0","  crossing_point <- ifelse(length(crossings) > 0, PK_values[crossings[1] + 1], NA)"
"0","  "
"0","  # Create plot"
"0","  plot(PK_values, confidence_values, type=""l"", lwd=2, col=""blue"","
"0","       main=""PK -> Confidence"", "
"0","       xlab=""Prior Knowledge"", ylab=""Confidence"","
"0","       xlim=c(0,1), ylim=c(0,1))"
"0","  "
"0","  # Add identity line (where confidence = knowledge)"
"0","  abline(0, 1, lty=2, col=""gray"")"
"0","  "
"0","  # Add key points from the paper with correct PK values"
"0","  points(0.324, 0.62, pch=19, col=""red"", cex=1.5)  # Bottom quartile (12th percentile)"
"0","  points(0.692, 0.75, pch=19, col=""green"", cex=1.5)  # Top quartile (90th percentile)"
"0","  "
"0","  # Mark crossing point"
"0","  if(!is.na(crossing_point)) {"
"0","    points(crossing_point, crossing_point, pch=19, col=""purple"", cex=1.5)"
"0","  }"
"0","  "
"0","  # Add legend"
"0","  legend(""bottomright"", "
"0","         legend=c(""Dunning-Kruger Curve"", ""Accurate self-assessment (PK=CONF)"", "
"0","                  ""12th Percentile (PK=0.324)"", ""90th Percentile (PK=0.692)"", "
"0","                  ""Confidence = Knowledge Crossing""),"
"0","         col=c(""blue"", ""gray"", ""red"", ""green"", ""purple""), "
"0","         lty=c(1,2,NA,NA,NA), pch=c(NA,NA,19,19,19), "
"0","         cex=0.8)"
"0","  "
"0","  # Add annotation about paper findings"
"0","  text(0.324, 0.62, ""  (0.324, 0.62)"", pos=4, cex=0.8)"
"0","  text(0.692, 0.75, ""  (0.692, 0.75)"", pos=4, cex=0.8)"
"0","  "
"0","  # Add subtitle about distribution"
"0","  title(sub=""Calibrated for truncated normal distribution with mean=0.5, sd=0.15"", cex.sub=0.8)"
"0","}"
"0",""
"0","plot_dunning_kruger()"
